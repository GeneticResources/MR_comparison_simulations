# Simulation studies for comparing methods for Mendelian randomization

### Individual-level simulations

Summary statistics are generated by simulating individual-level genotype and phenotype data followed by association analysis by linear regression. 

Located in folder `individual_level_simulations`:

* `bal_InSIDE_simulate_beta.R`: Individual-level simulations under balanced pleiotropy and InSIDE assumption satisfied.
* `bal_noInSIDE_simulate_beta.R`: Individual-level simulations under balanced pleiotropy and InSIDE assumption violated.
* `merge_individual_betahat.R`: Merge data from all simulation groups.
* `MR_analysis.R`: Conduct MR analysis on simulated summary statistics.

### Summary-level simulations

Summary statistics are simulated directly from the summary-level model implied by the individual-level model without generating individual genotype and phenotype data. Summary level simulations are substantially faster than individual-level simulations.

Located in folder `summary_level_simualtions`:

* `bal_InSIDE_smry.R`: Summary-level simulations under balanced pleiotropy and InSIDE assumption satisfied.
* `bal_noInSIDE_smry.R`: Summary-level simulations under balanced pleiotropy and InSIDE assumption violated.
* `dir_InSIDE_smry.R`: Summary-level simulations under directional pleiotropy and InSIDE assumption satisfied.
* `dir_noInSIDE_smry.R`: Summary-level simulations under directional pleiotropy and InSIDE assumption violated.

##### Function for MR-Lasso implementation

`MR_lasso.R`: function to implement MR-Lasso, obtained from the following paper:
Slob, Eric AW, and Stephen Burgess. "A Comparison Of Robust Mendelian Randomization Methods Using Summary Data." BioRxiv (2019): 577940.

